package com.gruettecloud.www;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNull;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.junit.Before;
import org.junit.Test;

public class Tests {
    private Dijkstra dijkstra;
    private DataStructures ds;

    @Before
    public void setUp() {
        DataStructures ds = new DataStructures("stuttgart.fmi");
        this.dijkstra = new Dijkstra(ds);
        this.ds = ds;
    }

    @Test
    public void testShortestPath1() {
        List<Integer> path = this.dijkstra.shortestPath(0, 1);
        ArrayList<Integer> expected = new ArrayList<Integer>(Arrays.asList(0, 1104376, 676235, 1104389, 1104394, 1104400, 153623, 1104414, 1104421, 676237, 1104439, 691564, 1104473, 1049962, 1104495, 1104504, 691568, 1104535, 153153, 1104566, 1, 1116));
        assertEquals(expected, path);
    }

    @Test
    public void testShortestPath2() {
        List<Integer> path = this.dijkstra.shortestPath(230423, 67485);
        ArrayList<Integer> expected = new ArrayList<Integer>(Arrays.asList(230423, 281548, 230413, 281549, 281550, 284211, 492766, 207219, 849501, 281540, 1115036, 281547, 705422, 1115037, 705420, 207218, 283981, 284212, 230005, 895028, 895029, 1060100, 229999, 284370, 739373, 205725, 733012, 895026, 733013, 895027, 205718, 990247, 231376, 985423, 
        205724, 205723, 985425, 985427, 1086350, 38268, 985429, 227873, 1080626, 38269, 1080621, 956363, 205714, 1076688, 1076691, 38270, 767255, 756892, 985432, 767256, 767258, 767259, 767260, 284189, 767267, 38271, 767271, 767273, 767274, 985433, 38272, 985441, 38273, 38274, 281604, 862642, 304060, 985442, 304059, 836560, 836559, 925546, 985443, 38275, 862649, 862648, 862647, 524251, 142378, 142363, 142364, 480616, 142365, 480617, 142366, 480618, 142367, 480619, 142368, 480620, 480621, 142369, 142370, 925552, 142361, 925554, 862632, 1107, 925564, 862629, 142360, 862635, 1106, 862628, 1105, 9024, 862626, 9025, 1104, 142359, 1103, 3399, 142358, 3400, 3401, 3402, 3403, 3404, 3405, 641537, 641535, 3406, 142357, 696524, 3407, 696526, 3408, 696528, 3409, 696530, 3410, 3411, 641524, 696532, 3412, 696534, 3413, 696907, 696536, 696910, 3414, 3415, 3416, 3417, 3418, 3419, 3420, 696912, 696914, 696916, 696918, 696920, 3421, 696922, 696924, 696926, 3422, 696928, 696930, 3423, 696932, 696934, 696936, 3424, 3425, 3426, 3427, 3428, 3429, 3430, 696938, 696940, 696942, 3431, 696944, 3432, 696946, 3433, 696948, 786812, 985710, 985711, 786907, 786814, 986187, 786966, 3434, 3435, 985713, 786815, 696967, 506883, 786977, 786817, 786818, 3436, 786823, 1061128, 786825, 3437, 786862, 786863, 786864, 3438, 786865, 786866, 786867, 3439, 786868, 3440, 786869, 696969, 3441, 786870, 696970, 786871, 3442, 696972, 786872, 3443, 696974, 3444, 696976, 3445, 696978, 3446, 3447, 3448, 786873, 786874, 786875, 3449, 3450, 696981, 786876, 3451, 3452, 786877, 786878, 3453, 786879, 786880, 786881, 786882, 786883, 786884, 786885, 3454, 696984, 786886, 786887, 786888, 3455, 786889, 3456, 786890, 786891, 786892, 3457, 696987, 3458, 3459, 3460, 696989, 696991, 786893, 786894, 786895, 3461, 786896, 3462, 786897, 786898, 3463, 786899, 786900, 3464, 3465, 786901, 786902, 3466, 786903, 696993, 3467, 696995, 3468, 3469, 696997, 3470, 786904, 3471, 786905, 3472, 3473, 786906, 3474, 793716, 793717, 793718, 793719, 3475, 3476, 786677, 3477, 786642, 142349, 3478, 786645, 786718, 3479, 3480, 3481, 3482, 3483, 697000, 697002, 3484, 697004, 3485, 697006, 697008, 697010, 3486, 697012, 697014, 697016, 3487, 697018, 3488, 3489, 697020, 697022, 3490, 697024, 697026, 697028, 3491, 697030, 697032, 697034, 3492, 697036, 697038, 697040, 3493, 697042, 697044, 697046, 3494, 3495, 697048, 697050, 3496, 697052, 3497, 697054, 697056, 3498, 697058, 3499, 697060, 3500, 697062, 697064, 697066, 3501, 3502, 697068, 3503, 697070, 697072, 697074, 3504, 697076, 697078, 697080, 3505, 697082, 697084, 697086, 3506, 697088, 697090, 697092, 3507, 697094, 697096, 3508, 3509, 3510, 41, 32116, 372094, 179846, 142347, 180133, 40, 697108, 32115, 697113, 697116, 32114, 697119, 697120, 372095, 697122, 386732, 697124, 697126, 3521, 697128, 3522, 330975, 990678, 697130, 757751, 3523, 32113, 386734, 697145, 3524, 3525, 697148, 697149, 3526, 697151, 3527, 697154, 697155, 697157, 3528, 697159, 179845, 697161, 3529, 3530, 3531, 697163, 3532, 3533, 3534, 697164, 3535, 697166, 3536, 
        697168, 697170, 697172, 3537, 3538, 3539, 3540, 3541, 3542, 3543, 3544, 3545, 3546, 3547, 3548, 697176, 697178, 697180, 697182, 697184, 142314, 179826, 3549, 142319, 697188, 574329, 3550, 147453, 147452, 3551, 990731, 623068, 3552, 623074, 3553, 623076, 623075, 623073, 623052, 3554, 697435, 697437, 3555, 697439, 697441, 697443, 3556, 697445, 3557, 697447, 697449, 3558, 3559, 3560, 3561, 697451, 3562, 697453, 697455, 697457, 3563, 697459, 697461, 697463, 3564, 697465, 697467, 697469, 3565, 697471, 697473, 697475, 3566, 697477, 3567, 697479, 697481, 3568, 697483, 697485, 697488, 3569, 697490, 142323, 697492, 697494, 697496, 3570, 697498, 697500, 697502, 3571, 697504, 3572, 697506, 697508, 3573, 3574, 697510, 697512, 3575, 697514, 3576, 697515, 697516, 697517, 3577, 697518, 697519, 697521, 3578, 3579, 697522, 3580, 697523, 3581, 697524, 697526, 3582, 697528, 3583, 697530, 3584, 697532, 3585, 453181, 453180, 697534, 3586, 697536, 697538, 697540, 3587, 697542, 3588, 697544, 697546, 697548, 697550, 697552, 757756, 330986, 697555, 3589, 697569, 330984, 697578, 697579, 455125, 3590, 697601, 697603, 697605, 3591, 697607, 697609, 697611, 3592, 697613, 3593, 697616, 3594, 697618, 697620, 3595, 697622, 697624, 697626, 3596, 697628, 3597, 3598, 697630, 3599, 3600, 1009971, 3601, 3602, 3603, 3604, 807060, 1009972, 3605, 807062, 625961, 11031, 697636, 807063, 697638, 697639, 945171, 11020, 807064, 11019, 697644, 807065, 429937, 807066, 11018, 625943, 384496, 807067, 625937, 8628, 807070, 8601, 625984, 168061, 475099, 625978, 381520, 109615, 945191, 807088, 475100, 384499, 697672, 8597, 697674, 625966, 934024, 8595, 168593, 712503, 712504, 712505, 712506, 934027, 712507, 712508, 712509, 712510, 8591, 934029, 625976, 135231, 672270, 672273, 672281, 672284, 143000, 672288, 672290, 672291, 672292, 143002, 712512, 712513, 934036, 934037, 143003, 934038, 712514, 712515, 712516, 143004, 712518, 384501, 143006, 712519, 384503, 712521, 1088257, 712523, 1088258, 712524, 143008, 1088259, 712526, 712528, 712530, 1088260, 712532, 1088261, 712533, 1088262, 143010, 1088263, 712535, 712537, 712538, 712540, 712541, 1088264, 712543, 993331, 712545, 712547, 712549, 712551, 712553, 712555, 712557, 1088265, 884647, 712559, 712560, 991996, 712562, 712563, 712565, 143013, 517832, 517834, 712576, 672361, 672362, 517837, 672363, 672364, 1088266, 8582, 712577, 712578, 712579, 672377, 712580, 712581, 672378, 712585, 712587, 712592, 712594, 712595, 712597, 712602, 712604, 712605, 712607, 712611, 712613, 712616, 712621, 712628, 712630, 712633, 712634, 712636, 712637, 712638, 712640, 712643, 712645, 712646, 712648, 712649, 712650, 712651, 712653, 712654, 712656, 712658, 712659, 712660, 712661, 712663, 712664, 712666, 712667, 712669, 712670, 712671, 712672, 712674, 712676, 712677, 712678, 712680, 712681, 712682, 990728, 712684, 712685, 931621, 712687, 712689, 353859, 850198, 517856, 850200, 712691, 8573, 850202, 517859, 712693, 143021, 931622, 517860, 11069, 838242, 517862, 719630, 11083, 8570, 719633, 107254, 850208, 143023, 155920, 934010, 838246, 934011, 509249, 8568, 509250, 719637, 719638, 719639, 509262, 850212, 517865, 8566, 993353, 719641, 517870, 605348, 8564, 517873, 8562, 517874, 143025, 517876, 850213, 8560, 850215, 517878, 461065, 143027, 850219, 517881, 850222, 8558, 461070, 850227, 517883, 850229, 143029, 889034, 8556, 517885, 143031, 517887, 8554, 719643, 850230, 517888, 850232, 850234, 719647, 8552, 517890, 143034, 517893, 850237, 8550, 838247, 933990, 517894, 933991, 90610, 838249, 8548, 933994, 517899, 155917, 155918, 720684, 934002, 838251, 838253, 838255, 720685, 8546, 8544, 720905, 8542, 8540, 8538, 8536, 143036, 8534, 143037, 8532, 143039, 8530, 903889, 8528, 143042, 8527, 690850, 690849, 8524, 690848, 690852, 359072, 8522, 143044, 1022680, 718795, 8520, 1022681, 359073, 1022683, 359075, 143046, 927244, 167747, 927245, 844081, 167748, 844086, 167749, 167750, 580453, 167751, 844100, 167752, 630624, 167755, 260191, 167756, 167757, 844099, 844091, 167758, 630651, 844084, 844083, 260190, 844082, 513300, 513291, 513290, 513289, 513299, 513298, 958033, 513297, 1028887, 518633, 518636, 518637, 958031, 1028885, 518638, 958028, 518635, 513283, 513282, 836771, 958026, 513281, 513280, 958021, 513279, 958019, 513262, 513260, 513273, 513272, 958022, 513271, 513270, 617906, 836768, 499552, 499550, 836767, 499549, 499548, 499547, 499546, 653845, 499545, 499551, 499558, 499557, 958012, 499556, 499555, 761114, 90470, 513263, 1040456, 90471, 689143, 513264, 90472, 513301, 689147, 957743, 957746, 90473, 957750, 90474, 674310, 90475, 90476, 957752, 90477, 543471, 456668, 90478, 590467, 90479, 543470, 90480, 90481, 674309, 90482, 518609, 838395, 90483, 90484, 90485, 590485, 590472, 90486, 90487, 646551, 590489, 646547, 90488, 646546, 90489, 646556, 90490, 646553, 90491, 646549, 90492, 90493, 90494, 90495, 90496, 90497, 90498, 90499, 491330, 90500, 491329, 90501, 491334, 90502, 90503, 1041590, 498477, 491343, 90504, 491335, 90505, 1041585, 461880, 491364, 491336, 1041581, 520029, 1041577, 90506, 456943, 272689, 1041510, 659512, 90507, 90508, 90509, 590469, 90510, 416803, 90511, 540097, 90512, 540098, 90513, 540099, 90514, 90515, 90516, 416801, 90517, 90518, 90519, 90520, 90521, 90522, 659302, 805595, 540100, 805594, 528102, 805593, 1047684, 528103, 416798, 805592, 446963, 74640, 1063235, 1063174, 1063173, 1063172, 1063171, 1063321, 458536, 90469, 458537, 544025, 74641, 665562, 638273, 1063187, 1063188, 543779, 1063191, 544027, 1063198, 74642, 1039990, 1063208, 528054, 1063211, 74643, 528055, 294671, 468775, 74644, 1000588, 1064561, 544019, 528056, 446785, 544028, 1064563, 362984, 544031, 457583, 1064567, 544030, 528057, 646893, 1064573, 670627, 457584, 1063356, 90615, 670632, 491378, 646895, 90616, 485419, 485425, 988921, 74645, 670640, 447147, 994254, 90617, 74646, 485426, 559232, 294662, 553026, 447145, 655598, 74647, 711217, 711218, 74648, 458522, 447148, 458523, 74649, 458524, 458525, 458526, 74650, 458527, 74651, 485427, 74652, 484177, 1038929, 74653, 540955, 22382, 638274, 22381, 22380, 468393, 468394, 22379, 468395, 22378, 633311, 22377, 975344, 22376, 975343, 22375, 22374, 22373, 22372, 22371, 22370, 1073202, 689350, 1014067, 1073203, 1073204, 1014068, 689354, 689356, 1073205, 806052, 468396, 446995, 446996, 447001, 540950, 446999, 510508, 1013457, 1013456, 1013455, 429006, 828608, 828610, 634687, 828612, 571998, 828613, 1013454, 1013449, 1013450, 1013451, 1013452, 1013453, 828614, 709222, 828611, 22369, 828609, 510509, 828607, 22367, 22368, 723246, 828606, 828604, 22366, 668987, 468400, 510510, 22365, 629975, 510511, 510512, 22364, 828603, 405660, 828605, 1017182, 1017183, 1017184, 1017185, 1017186, 1017187, 1017188, 53614, 1013479, 53212, 1126736, 1024769, 1013480, 477309, 724302, 1128525, 489587, 634689, 22363, 510517, 841558, 510516, 468403, 468402, 318823, 1013484, 1013483, 596177, 546142, 1013387, 1013386, 1013385, 1013384, 552942, 1013383, 1013382, 1013381, 1013380, 552937, 552933, 1013379, 1013378, 1013377, 552940, 1013376, 552936, 552943, 1013375, 1013374, 552939, 552935, 1013373, 1013396, 1013485, 22362, 22361, 1010859, 608924, 22360, 1011643, 318824, 22359, 1013339, 546141, 546140, 546139, 22358, 546138, 1013338, 318825, 22357, 1013517, 318826, 546137, 546136, 1013326, 22356, 979465, 521461, 689569, 521462, 979464, 22355, 608890, 408593, 408594, 22354, 1013787, 767571, 22353, 723999, 370849, 723997, 22352, 555296, 22351, 767572, 1015704, 962684, 962683, 962680, 22350, 1013162, 545562, 545561, 1013980, 507255, 545560, 22349, 545559, 510204, 545558, 22348, 1013979, 545557, 370848, 1013802, 1013161, 507286, 1013803, 1013804, 1013983, 22347, 507287, 22346, 1015688, 1013805, 545556, 22345, 545555, 366111, 545554, 1015686, 545553, 22344, 1015685, 510206, 286939, 1016001, 22343, 727552, 1016000, 22342, 510209, 727553, 22341, 727554, 510210, 22340, 1012918, 1012919, 510211, 1012920, 22339, 727555, 894243, 569000, 22338, 727556, 568993, 727557, 727558, 318828, 495639, 727559, 22337, 727560, 568996, 727561, 318827, 727564, 487536, 22336, 558311, 558310, 727568, 767573, 727567, 22335, 558309, 410878, 796331, 568994, 727562, 727563, 22334, 727566, 22333, 727570, 1115701, 1115706, 568997, 727573, 22332, 727577, 727578, 410877, 568998, 1115685, 568995, 1115678, 22331, 455807, 479315, 479316, 487537, 466270, 271654, 479270, 479269, 1115705, 1115690, 479271, 1115711, 479268, 479272, 1115714, 1115686, 479273, 1115684, 22330, 1115707, 479274, 479275, 1115680, 479276, 1115709, 22329, 1115708, 689411, 479277, 1115682, 479317, 479318, 22328, 1115687, 479239, 1115710, 479238, 1115688, 1115692, 479237, 1115675, 1115683, 479236, 479241, 1115676, 1115679, 1115677, 479240, 1115673, 1115681, 479613, 479278, 1115689, 1115694, 479299, 999292, 479300, 1115699, 1115697, 22327, 1115693, 1115696, 689438, 22326, 479253, 480271, 480273, 479254, 479257, 479256, 479255, 479259, 479258, 22325, 479260, 1115872, 479261, 1115873, 479263, 1115871, 479262, 1115870, 22324, 479264, 79562, 318829, 547029, 396251, 1115869, 521760, 479599, 521758, 79561, 79473, 396239, 521763, 79474, 79475, 79476, 1125564, 79477, 79478, 79479, 79480, 674356, 79481, 674358, 674357, 79482, 674354, 693842, 79483, 79484, 79485, 674349, 1115886, 79486, 1115883, 674348, 79487, 796447, 1115884, 79488, 1115881, 79489, 79490, 1115879, 79491, 674350, 79492, 674351, 674352, 674353, 79493, 674355, 79494, 674359, 79495, 674363, 79496, 674364, 79497, 674360, 79498, 674361, 79499, 674362, 79500, 674365, 674366, 79501, 674367, 79502, 674368, 796348, 79503, 79504, 674369, 79505, 79506, 674370, 674371, 79507, 79508, 674372, 674373, 674374, 79509, 674375, 79510, 674376, 79511, 674377, 674378, 911254, 900535, 79512, 674379, 79513, 79514, 674380, 674381, 674382, 79515, 674383, 1115649, 674384, 1115651, 1115650, 79516, 79517, 1115648, 79518, 79519, 1115647, 674385, 79520, 674386, 1115614, 674387, 79521, 1115601, 79522, 1115616, 79523, 79524, 79525, 79526, 674455, 1115891, 674456, 674457, 79527, 674618, 674619, 674620, 674622, 674623, 1115582, 674624, 674625, 674627, 674630, 1115559, 674483, 1115570, 79533, 79534, 674489, 1115562, 1115561, 79535, 674490, 674491, 79536, 1115560, 674492, 79537, 79538, 79539, 79540, 79541, 79542, 674493, 79543, 674494, 79544, 79545, 674513, 79546, 79547, 674517, 674518, 79548, 79549, 796391, 505134, 79550, 674526, 674529, 79551, 674532, 674533, 79552, 674534, 79553, 674535, 79554, 674536, 674537, 674538, 79555, 674539, 674543, 79556, 701507, 653531, 653530, 79557, 79558, 497742, 79559, 674554, 497743, 434610, 434611, 434612, 434603, 79560, 497744, 79459, 845403, 845401, 486669, 434591, 434613, 434577, 1118599, 764672, 1118597, 1118593, 1118604, 1118601, 186738, 186737, 884798, 186736, 186735, 186734, 689161, 434973, 186733, 689162, 186732, 186731, 186730, 1118596, 186729, 1118598, 1118595, 1118602, 1118592, 186728, 434618, 1118594, 1118600, 186727, 186726, 689159, 486668, 186725, 486667, 486666, 486665, 486664, 486663, 486662, 186724, 486688, 186723, 451560, 451559, 186722, 451558, 451557, 170581, 656192, 486368, 170582, 486327, 170583, 695970, 453193, 170584, 170585, 170586, 546314, 667148, 170587, 656191, 434921, 170588, 170589, 60471, 621430, 60474, 60470, 621432, 667149, 60469, 667150, 60468, 60467, 60466, 60465, 1030197, 1030190, 1030191, 1030192, 1030193, 428764, 1028777, 1028783, 60464, 1028782, 1028781, 1028779, 60463, 621433, 60462, 1028778, 621434, 60461, 621435, 840801, 733861, 733864, 733866, 1025218, 733867, 1023316, 1023315, 840798, 1029789, 1029790, 733858, 1029791, 1029792, 733855, 1029793, 733852, 733851, 733850, 733853, 733854, 1029786, 733856, 546576, 733857, 733859, 733860, 733863, 170646, 733872, 8465, 840804, 8463, 840805, 546578, 8461, 840806, 840807, 8459, 840810, 840812, 8457, 733878, 840813, 8455, 672418, 483419, 8453, 840817, 8451, 840820, 733879, 733883, 840821, 840823, 8448, 840825, 733887, 840827, 733892, 1022687, 1022688, 733895, 734783, 733901, 8445, 1128386, 8444, 8443, 733909, 733911, 8441, 8439, 723277, 8437, 733923, 733924, 723279, 8436, 8434, 923989, 951172, 690842, 733927, 8432, 923990, 883459, 8431, 735093, 735095, 8429, 883460, 723281, 8427, 723283, 849966, 8425, 483420, 735104, 849968, 849969, 8423, 849971, 849973, 849974, 8421, 849976, 849978, 8419, 849980, 849981, 849982, 849986, 849989, 735106, 354951, 8417, 735108, 735110, 735111, 850000, 735109, 849999, 10155, 849997, 690834, 849996, 10157, 690828, 646198, 646203, 646188, 646193, 849991, 10159, 488522, 10160, 525367, 166713, 849994, 525360, 849993, 387049, 535817, 778506, 401632, 535818, 10161, 401633, 10162, 495593, 406774, 991027, 406773, 10163, 665785, 775002, 495592, 10164, 665788, 665787, 766118, 10165, 10166, 532881, 775001, 876362, 10167, 754575, 403073, 811619, 10168, 10169, 775003, 10170, 773485, 10171, 10172, 773486, 10173, 761843, 462706, 462705, 462704, 462703, 462702, 462701, 67489, 812918, 462700, 754532, 462699, 462698, 754543, 462697, 462696, 67488, 462695, 462694, 754535, 991087, 462693, 527726, 462692, 67487, 404062, 462691, 778507, 67486, 462690, 812891, 991028, 605205, 462689, 754533, 67485, 393007));
        assertEquals(expected, path);
    }

    @Test
    public void nearestNode1() {
        double[] node = this.ds.getNearestNode(48.831853, 9.185623, 0.01);
        double expected = 849418.0;
        assertEquals(expected, node[0], 0.001);
    }

    @Test
    public void nearestNode2() {
        double[] node = this.ds.getNearestNode(48.823065, 8.887945, 0.01);
        double expected = 1089115.0;
        assertEquals(expected, node[0], 0.001);
    }
}